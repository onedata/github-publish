#!/usr/bin/env python

import yaml
import subprocess

f = open('config.yml')
repos = yaml.load(f)

for repo_name, repo in repos.iteritems():
  subprocess.call([
  "bash","-c",
  "/bin/sr-publish -s {} -d {} -b '{}' -t '{}' --tmpdir /tmp --sid {} --did {}".format(
  repo["src"],
  repo["dst"],
   '%s' % ' '.join(map(str,repo["branches"])) if 'branches' in repo else "",
    '%s' % ' '.join(map(str,repo["tags"])) if 'tags' in repo else "",
  repo["sid"],
  repo["did"])
  ])
